<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResumeIQ 2.0 | Advanced Intelligence Engine</title>
    <!-- Premium Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    animation: {
                        'spin-slow': 'spin-slow 12s linear infinite',
                        'pulse-slow': 'pulse-slow 4s ease-in-out infinite',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes spin-slow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        @keyframes pulse-slow {
            0%, 100% { opacity: 0.1; }
            50% { opacity: 0.3; }
        }
        .animate-spin-slow { animation: spin-slow 12s linear infinite; }
        .glass {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(226, 232, 240, 0.5);
        }
        .dark .glass {
            background: rgba(12, 17, 29, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        .hero-gradient {
            background: radial-gradient(circle at 50% 50%, rgba(79, 70, 229, 0.15) 0%, transparent 70%);
        }
        .section-transition {
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .hidden-section {
            display: none;
            opacity: 0;
            transform: translateY(20px);
        }
        .visible-section {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(79, 70, 229, 0.2); border-radius: 10px; }
    </style>
</head>
<body class="bg-[#f8fafc] dark:bg-[#05070a] text-slate-900 dark:text-slate-100 min-h-screen transition-colors duration-700">

    <!-- Fluid Background -->
    <div class="fixed inset-0 pointer-events-none z-0 overflow-hidden">
        <div id="glow-1" class="absolute top-[-10%] left-[-10%] w-[80%] h-[80%] hero-gradient blur-[100px] animate-pulse-slow"></div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-[100] px-4 py-4 sm:px-8 sm:py-8">
        <div class="max-w-7xl mx-auto flex items-center justify-between glass rounded-2xl sm:rounded-[2.5rem] px-4 py-3 sm:px-8 sm:py-4 shadow-2xl">
            <div class="flex items-center gap-3 sm:gap-4 cursor-pointer group" onclick="showSection('landing')">
                <div class="w-10 h-10 sm:w-12 sm:h-12 bg-indigo-600 rounded-xl sm:rounded-2xl flex items-center justify-center shadow-lg transition-transform group-hover:rotate-6">
                    <i data-lucide="shield-check" class="text-white w-6 h-6 sm:w-7 sm:h-7"></i>
                </div>
                <span class="text-xl sm:text-2xl font-black tracking-tighter uppercase italic">ResumeIQ <span class="text-indigo-600 dark:text-indigo-400 font-medium">2.0</span></span>
            </div>
            
            <div class="hidden lg:flex items-center gap-10">
                <a href="#" class="text-[11px] font-black uppercase tracking-[0.3em] text-slate-600 dark:text-slate-400 hover:text-indigo-600 transition-colors">Methodology</a>
                <a href="#" class="text-[11px] font-black uppercase tracking-[0.3em] text-slate-600 dark:text-slate-400 hover:text-indigo-600 transition-colors">Enterprise</a>
                <a href="#" class="text-[11px] font-black uppercase tracking-[0.3em] text-slate-600 dark:text-slate-400 hover:text-indigo-600 transition-colors">Dossier</a>
            </div>

            <div class="flex items-center gap-2 sm:gap-5">
                <button onclick="toggleTheme()" class="w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-xl sm:rounded-2xl glass hover:bg-indigo-500/10">
                    <i data-lucide="sun" id="sun-icon" class="hidden text-amber-400"></i>
                    <i data-lucide="moon" id="moon-icon" class="text-slate-600"></i>
                </button>
                <button class="hidden sm:flex h-10 sm:h-12 px-8 rounded-xl sm:rounded-2xl glass text-[10px] font-black uppercase tracking-widest border-indigo-500/30 items-center justify-center">Connect Node</button>
                <button class="lg:hidden w-10 h-10 flex items-center justify-center rounded-xl glass text-indigo-600" onclick="toggleMenu()">
                    <i data-lucide="menu"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Content Sections -->
    <main class="relative z-10 pt-28 sm:pt-40 pb-20 px-4 sm:px-8 max-w-7xl mx-auto">
        
        <!-- Section: Landing -->
        <section id="landing-section" class="visible-section text-center py-10 sm:py-20">
            <div class="inline-flex items-center gap-3 px-6 py-2 sm:px-8 sm:py-3 rounded-full glass shadow-xl mb-8 sm:mb-14">
                <span class="relative flex h-2 w-2 sm:h-3 sm:w-3">
                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-2 w-2 sm:h-3 sm:w-3 bg-indigo-500"></span>
                </span>
                <span class="text-[8px] sm:text-[10px] font-black uppercase tracking-[0.3em] sm:tracking-[0.4em] text-slate-600 dark:text-slate-300 uppercase tracking-widest">Neural Ingestion Protocol Active</span>
            </div>
            <h1 class="text-4xl sm:text-7xl md:text-9xl font-black tracking-tighter leading-[0.9] sm:leading-[0.85] mb-8 sm:mb-12 dark:text-white px-2 italic uppercase">
                Stop Guessing. <br> 
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 via-violet-500 to-indigo-400">Dominate.</span>
            </h1>
            <p class="text-base sm:text-2xl text-slate-700 dark:text-slate-400 max-w-3xl mx-auto mb-12 sm:mb-20 leading-relaxed font-medium">
                ResumeIQ 2.0 analyzes your document through 50,000+ hiring parameters used by top FAANG systems to ensure visual and semantic perfection.
            </p>
            <div class="flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-8 mb-24 sm:mb-40">
                <button onclick="showSection('input')" class="w-full sm:w-96 h-16 sm:h-20 bg-indigo-600 text-white rounded-3xl font-bold text-lg sm:text-xl shadow-2xl hover:bg-indigo-500 transition-all flex items-center justify-center gap-4 uppercase tracking-widest">
                    Scan Resume <i data-lucide="arrow-right"></i>
                </button>
                <button class="w-full sm:w-96 h-16 sm:h-20 glass rounded-3xl font-bold text-lg sm:text-xl border-slate-300 dark:border-white/20 transition-all uppercase tracking-widest">View Dossier</button>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 sm:gap-10">
                <div class="glass p-4 sm:p-8 rounded-3xl text-center">
                    <i data-lucide="shield-check" class="text-indigo-600 dark:text-indigo-400 mx-auto mb-4"></i>
                    <div class="text-[8px] sm:text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1">ATS Vetted</div>
                    <div class="text-base sm:text-lg font-black italic uppercase">Tier 1</div>
                </div>
                <div class="glass p-4 sm:p-8 rounded-3xl text-center">
                    <i data-lucide="target" class="text-indigo-600 dark:text-indigo-400 mx-auto mb-4"></i>
                    <div class="text-[8px] sm:text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1">Precision</div>
                    <div class="text-base sm:text-lg font-black italic">99.8%</div>
                </div>
                <div class="glass p-4 sm:p-8 rounded-3xl text-center">
                    <i data-lucide="zap" class="text-indigo-600 dark:text-indigo-400 mx-auto mb-4"></i>
                    <div class="text-[8px] sm:text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1">Velocity</div>
                    <div class="text-base sm:text-lg font-black italic uppercase">< 4s</div>
                </div>
                <div class="glass p-4 sm:p-8 rounded-3xl text-center">
                    <i data-lucide="cpu" class="text-indigo-600 dark:text-indigo-400 mx-auto mb-4"></i>
                    <div class="text-[8px] sm:text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1">Algorithm</div>
                    <div class="text-base sm:text-lg font-black italic uppercase">V2.0</div>
                </div>
            </div>
        </section>

        <!-- Section: Input -->
        <section id="input-section" class="hidden-section max-w-5xl mx-auto">
            <div class="flex items-center justify-between mb-8 sm:mb-16">
                <div>
                    <h2 class="text-3xl sm:text-5xl font-black italic tracking-tighter uppercase">Ingestion</h2>
                    <p class="text-slate-600 dark:text-slate-400 mt-1 sm:mt-3 font-bold uppercase text-[9px] sm:text-[10px] tracking-[0.4em]">Phase Alpha / Node 01</p>
                </div>
                <button onclick="showSection('landing')" class="w-12 h-12 glass rounded-2xl flex items-center justify-center">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-12">
                <!-- File Upload Container -->
                <div class="glass p-4 sm:p-6 rounded-[2.5rem] relative group cursor-pointer overflow-hidden">
                    <div id="drop-zone" class="border-4 border-dashed border-slate-300 dark:border-white/5 rounded-[2rem] p-10 sm:p-16 text-center hover:bg-white/5 transition-all flex flex-col items-center justify-center min-h-[400px]">
                        <input type="file" id="file-input" class="hidden" accept=".pdf,.docx">
                        
                        <div id="upload-prompt" class="contents">
                            <div class="w-20 h-20 sm:w-28 sm:h-28 bg-indigo-600/10 rounded-3xl flex items-center justify-center text-indigo-600 mx-auto mb-10 group-hover:scale-110 transition-transform">
                                <i data-lucide="upload" class="w-12 h-12"></i>
                            </div>
                            <h3 class="text-xl sm:text-3xl font-black mb-4 tracking-tight uppercase">Transmit Data</h3>
                            <p class="text-slate-600 dark:text-slate-400 font-bold uppercase text-xs tracking-widest mb-10 italic">PDF (Max 15MB)</p>
                            <button onclick="triggerFileInput()" class="px-8 py-3 rounded-xl border-2 border-indigo-600 text-indigo-600 text-xs font-black uppercase tracking-widest hover:bg-indigo-600 hover:text-white transition-all">Select File</button>
                        </div>

                        <div id="file-selected" class="hidden flex flex-col items-center">
                            <div class="w-20 h-20 sm:w-28 sm:h-28 bg-emerald-500/10 rounded-3xl flex items-center justify-center text-emerald-500 mx-auto mb-8">
                                <i data-lucide="file-check" class="w-12 h-12"></i>
                            </div>
                            <h3 id="filename-display" class="text-lg sm:text-xl font-black mb-4 tracking-tight uppercase truncate max-w-[250px]">Filename.pdf</h3>
                            <p class="text-slate-600 dark:text-slate-400 font-bold uppercase text-[10px] tracking-widest mb-10">Ready for Scan</p>
                            <div class="flex flex-col gap-4 w-full">
                                <button onclick="startAnalysis()" class="w-full py-4 bg-indigo-600 text-white rounded-2xl font-black text-sm uppercase tracking-widest shadow-xl hover:bg-indigo-500 transition-all">Start Intelligence Scan</button>
                                <button onclick="resetUpload()" class="w-full py-4 glass text-slate-500 rounded-2xl font-black text-[10px] uppercase tracking-widest">Change File</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Secondary Context -->
                <div class="space-y-6 sm:space-y-8">
                    <div class="glass p-6 sm:p-8 rounded-[2rem]">
                        <div class="flex items-center justify-between mb-8">
                            <div class="flex items-center gap-4">
                                <div class="w-10 h-10 sm:w-12 sm:h-12 bg-indigo-600/10 rounded-2xl flex items-center justify-center text-indigo-600">
                                    <i data-lucide="briefcase"></i>
                                </div>
                                <div>
                                    <h4 class="font-black italic text-lg uppercase">Job Targeting</h4>
                                    <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest">Optional Engine</p>
                                </div>
                            </div>
                            <span class="px-3 py-1 glass rounded-full text-[9px] font-black uppercase text-slate-400 border border-white/5 tracking-widest">v2.0 Beta</span>
                        </div>
                        <div id="jd-input-container" class="contents">
                            <textarea id="jd-text" placeholder="Paste Job Description for targeted matching... (Leave empty for general audit)" class="w-full h-40 p-4 rounded-2xl bg-white dark:bg-black/20 border border-slate-200 dark:border-white/10 text-slate-700 dark:text-slate-300 text-sm outline-none focus:border-indigo-500 transition-all"></textarea>
                        </div>
                    </div>
                    <div class="flex gap-4 p-6 rounded-[2rem] bg-indigo-600 text-white shadow-xl">
                        <i data-lucide="shield-alert" class="shrink-0"></i>
                        <p class="text-[9px] sm:text-[11px] font-bold uppercase tracking-widest leading-relaxed">ResumeIQ Note: High-security EPHEMERAL processing mode active.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section: Analyzing -->
        <section id="analyzing-section" class="hidden-section max-w-2xl mx-auto py-10 text-center">
            <div class="relative w-40 h-40 sm:w-56 sm:h-56 mx-auto mb-12 sm:mb-20">
                <svg class="w-full h-full transform -rotate-90">
                    <circle cx="50%" cy="50%" r="45%" fill="transparent" stroke="currentColor" stroke-width="2" class="text-slate-300 dark:text-white/5"></circle>
                    <circle id="progress-circle" cx="50%" cy="50%" r="45%" fill="transparent" stroke="currentColor" stroke-width="8" stroke-dasharray="283" stroke-dashoffset="283" stroke-linecap="round" class="text-indigo-600 transition-all duration-300"></circle>
                </svg>
                <div class="absolute inset-0 flex flex-col items-center justify-center">
                    <span id="progress-text" class="text-4xl sm:text-6xl font-black italic">0%</span>
                    <span id="analyzing-label" class="text-[8px] sm:text-[10px] font-black text-slate-500 uppercase tracking-widest">Processing</span>
                </div>
            </div>
            
            <div id="patience-reminder" class="hidden glass p-4 rounded-2xl border-indigo-500/20 mb-10 animate-pulse text-indigo-500 font-bold text-xs uppercase tracking-widest">
                Deep-processing logic in progress... Do not refresh.
            </div>

            <div id="analysis-steps" class="space-y-4 text-left">
                <!-- Steps injected via JS -->
            </div>
        </section>

        <!-- Section: Dashboard -->
        <section id="dashboard-section" class="hidden-section">
            <div class="flex flex-col lg:flex-row items-start lg:items-end justify-between mb-10 sm:mb-20 gap-6">
                <div>
                    <span class="px-4 py-1.5 rounded-full bg-emerald-500/10 text-emerald-600 border border-emerald-500/20 text-[10px] font-black uppercase tracking-widest">Forensic Scan Complete</span>
                    <h2 class="text-4xl sm:text-6xl font-black italic tracking-tighter mt-6 uppercase">Dossier</h2>
                    <div class="flex gap-6 mt-4">
                        <p class="text-slate-500 font-mono text-xs uppercase">HASH_REF: 0x992B-X</p>
                        <p class="text-slate-500 font-mono text-xs uppercase hidden sm:block">Secured: Yes</p>
                    </div>
                </div>
                <div class="flex items-center gap-4 w-full lg:w-auto">
                    <button onclick="showSection('input'); resetUpload();" class="flex-1 lg:flex-none h-16 glass px-8 rounded-3xl flex items-center justify-center hover:bg-white/5">
                        <i data-lucide="refresh-ccw"></i>
                    </button>
                    <button class="flex-1 lg:flex-none h-16 bg-indigo-600 text-white px-10 rounded-3xl font-bold uppercase tracking-widest flex items-center justify-center gap-3">
                        Export Dossier <i data-lucide="download"></i>
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-10 mb-10">
                <div class="lg:col-span-5 glass p-10 rounded-[2.5rem] flex flex-col items-center justify-center">
                    <div class="w-64 h-64 sm:w-80 sm:h-80 rounded-full bg-slate-100 dark:bg-black/40 border-[24px] border-white dark:border-white/5 flex items-center justify-center relative shadow-2xl">
                        <div id="score-ring-glow" class="absolute inset-[-10px] rounded-full blur-2xl opacity-10"></div>
                        <div id="score-ring" class="absolute inset-2 rounded-full border-[6px] border-indigo-500 animate-spin-slow"></div>
                        <div class="text-center">
                            <span id="main-score" class="text-7xl sm:text-9xl font-black italic drop-shadow-lg">--</span>
                            <div class="text-[10px] font-black uppercase tracking-[0.5em] text-indigo-500 -mt-2">ResumeIQ Score</div>
                        </div>
                    </div>
                    <div class="mt-10 text-center">
                        <div id="score-badge" class="px-6 py-2 rounded-full text-[10px] font-black uppercase tracking-widest inline-block mb-6 shadow-xl">Evaluating...</div>
                        <p id="ats-summary" class="text-slate-600 dark:text-slate-400 font-bold italic leading-relaxed text-sm">Synthetic intelligence audit complete. Review the forensic findings below.</p>
                    </div>
                </div>
                
                <div class="lg:col-span-7 grid grid-cols-1 sm:grid-cols-2 gap-6">
                    <div class="glass p-8 rounded-[2rem] flex flex-col justify-between">
                        <div class="flex justify-between items-start">
                            <div class="w-12 h-12 rounded-xl bg-emerald-500/10 text-emerald-500 flex items-center justify-center"><i data-lucide="layers"></i></div>
                            <span id="stat-parsing" class="text-3xl font-black italic">--</span>
                        </div>
                        <div class="mt-8">
                            <h4 class="text-[10px] font-black uppercase tracking-widest text-slate-500">Parsing Integrity</h4>
                            <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mt-1">Structure Verified</p>
                        </div>
                    </div>
                    <div class="glass p-8 rounded-[2rem] flex flex-col justify-between">
                        <div class="flex justify-between items-start">
                            <div class="w-12 h-12 rounded-xl bg-indigo-500/10 text-indigo-500 flex items-center justify-center"><i data-lucide="target"></i></div>
                            <span id="stat-match" class="text-3xl font-black italic">--</span>
                        </div>
                        <div class="mt-8">
                            <h4 class="text-[10px] font-black uppercase tracking-widest text-slate-500">Targeting Precision</h4>
                            <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mt-1">Keyword Sync</p>
                        </div>
                    </div>
                    <div class="glass p-8 rounded-[2rem] flex flex-col justify-between">
                        <div class="flex justify-between items-start">
                            <div class="w-12 h-12 rounded-xl bg-amber-500/10 text-amber-500 flex items-center justify-center"><i data-lucide="activity"></i></div>
                            <span class="text-3xl font-black italic">Analyzed</span>
                        </div>
                        <div class="mt-8">
                            <h4 class="text-[10px] font-black uppercase tracking-widest text-slate-500">Impact Factor</h4>
                            <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mt-1">Tone Recognition</p>
                        </div>
                    </div>
                    <div class="glass p-8 rounded-[2rem] flex flex-col justify-between">
                        <div class="flex justify-between items-start">
                            <div class="w-12 h-12 rounded-xl bg-blue-500/10 text-blue-500 flex items-center justify-center"><i data-lucide="file-check"></i></div>
                            <span class="text-3xl font-black italic">Passed</span>
                        </div>
                        <div class="mt-8">
                            <h4 class="text-[10px] font-black uppercase tracking-widest text-slate-500">ATS Format</h4>
                            <p class="text-xs font-bold text-slate-400 uppercase tracking-widest mt-1">Legacy Validated</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Strategic Intelligence Breakdown (Pros & Cons) -->
            <div id="forensic-log-container" class="space-y-10">
                <!-- Bullet points will be rendered here -->
            </div>
        </section>
    </main>

    <!-- JS Logic -->
    <script>
        // State
        let isDarkMode = true;
        let jobMode = false;
        let currentView = 'landing';
        const steps = [
            { label: "Initializing Neural Ingestion", icon: "layers" },
            { label: "Scanning Semantic Context", icon: "search" },
            { label: "Cross-Referencing Global Benchmarks", icon: "globe" },
            { label: "Identifying Action Verb Gaps", icon: "activity" },
            { label: "Final Intelligence Synthesis", icon: "sparkles" }
        ];

        // Initialization
        window.onload = () => {
            lucide.createIcons();
            initBackground();
            initFileHandling();
        };

        function triggerFileInput() {
            document.getElementById('file-input').click();
        }

        function initFileHandling() {
            const fileInput = document.getElementById('file-input');
            const uploadPrompt = document.getElementById('upload-prompt');
            const fileSelected = document.getElementById('file-selected');
            const filenameDisplay = document.getElementById('filename-display');

            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    filenameDisplay.innerText = file.name;
                    uploadPrompt.classList.add('hidden');
                    fileSelected.classList.remove('hidden');
                }
            });
        }

        function resetUpload() {
            document.getElementById('file-input').value = '';
            document.getElementById('upload-prompt').classList.remove('hidden');
            document.getElementById('file-selected').classList.add('hidden');
        }

        function showSection(view) {
            const sections = ['landing', 'input', 'analyzing', 'dashboard'];
            sections.forEach(s => {
                const el = document.getElementById(`${s}-section`);
                if (s === view) {
                    el.classList.remove('hidden-section');
                    el.classList.add('visible-section');
                } else {
                    el.classList.add('hidden-section');
                    el.classList.remove('visible-section');
                }
            });
            currentView = view;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.documentElement.classList.toggle('dark');
            document.getElementById('sun-icon').classList.toggle('hidden');
            document.getElementById('moon-icon').classList.toggle('hidden');
        }

        // Logic to extract match percentage
        function parseMatchScore(text) {
            const match = text.match(/(\d+)%/);
            if (match) return parseInt(match[1]);
            // Fallback: search for stand-alone numbers if % is missing
            const numMatch = text.match(/score:?\s*(\d+)/i);
            return numMatch ? parseInt(numMatch[1]) : 75;
        }

        async function startAnalysis() {
            const fileInput = document.getElementById('file-input');
            const jdInput = document.getElementById('jd-text');

            if (!fileInput.files[0]) return alert("Please select a resume file.");
            
            // If JD is empty, we handle it on the frontend by sending a placeholder
            const finalJD = jdInput.value.trim() || "General Comprehensive Resume Audit for Professional Excellence";

            showSection('analyzing');
            document.getElementById('patience-reminder').classList.add('hidden');
            
            let progress = 0;
            const progressCircle = document.getElementById('progress-circle');
            const progressText = document.getElementById('progress-text');
            const stepsContainer = document.getElementById('analysis-steps');
            
            stepsContainer.innerHTML = '';
            steps.forEach((step, i) => {
                const stepEl = document.createElement('div');
                stepEl.id = `step-${i}`;
                stepEl.className = `flex items-center justify-between p-5 glass rounded-2xl opacity-40 transition-all duration-500`;
                stepEl.innerHTML = `
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-xl bg-slate-200 dark:bg-white/5 flex items-center justify-center">
                            <i data-lucide="${step.icon}" class="w-5 h-5"></i>
                        </div>
                        <span class="text-xs font-black uppercase tracking-widest">${step.label}</span>
                    </div>
                `;
                stepsContainer.appendChild(stepEl);
            });
            lucide.createIcons();

            const animationInterval = setInterval(() => {
                if (progress < 90) {
                    progress += 1;
                    updateUIProgress(progress);
                } else if (progress === 90) {
                    // Reveal friendly reminder at 90%
                    document.getElementById('patience-reminder').classList.remove('hidden');
                }
            }, 100);

            const formData = new FormData();
            formData.append('resume', fileInput.files[0]);
            formData.append('job_description', finalJD);

            try {
                const response = await fetch('http://localhost:8080/analyze', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) throw new Error("Connection failed. Ensure backend is running at port 8080.");

                const data = await response.json();
                
                progress = 100;
                updateUIProgress(100);
                clearInterval(animationInterval);
                
                setTimeout(() => renderResults(data), 800);

            } catch (err) {
                clearInterval(animationInterval);
                alert("Error: " + err.message);
                showSection('input');
            }
        }

        function updateUIProgress(p) {
            const progressCircle = document.getElementById('progress-circle');
            const progressText = document.getElementById('progress-text');
            const dashoffset = 283 - (283 * p / 100);
            progressCircle.setAttribute('stroke-dashoffset', dashoffset);
            progressText.innerText = `${p}%`;

            const stepIndex = Math.min(Math.floor(p / (100 / steps.length)), steps.length - 1);
            for(let j=0; j<steps.length; j++) {
                const el = document.getElementById(`step-${j}`);
                if (j < stepIndex) {
                    el.classList.replace('opacity-40', 'opacity-60');
                    el.classList.add('bg-emerald-500/10', 'text-emerald-500');
                } else if (j === stepIndex) {
                    el.classList.replace('opacity-40', 'opacity-100');
                    el.classList.add('bg-indigo-600', 'text-white', 'scale-105');
                }
            }
        }

        // Helper to format text into bullet points
        function formatBullets(text) {
            if (!text) return "<li>No specific data available.</li>";
            // Split by newlines, bullets (- or *), or numbers
            const items = text.split(/\n|(?:\s*[\-\*\â€¢]\s*)|(?:\d+\.\s*)/).filter(i => i.trim().length > 5);
            if (items.length === 0) return `<li>${text}</li>`;
            return items.map(item => `<li class="flex gap-3 mb-3 items-start"><span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-current shrink-0"></span><span>${item.trim()}</span></li>`).join('');
        }

        function renderResults(data) {
            showSection('dashboard');
            
            const score = parseMatchScore(data.ats_result);
            
            const mainScoreEl = document.getElementById('main-score');
            const scoreRing = document.getElementById('score-ring');
            const scoreGlow = document.getElementById('score-ring-glow');
            const badge = document.getElementById('score-badge');
            
            mainScoreEl.innerText = score;
            document.getElementById('stat-parsing').innerText = 'Valid';
            document.getElementById('stat-match').innerText = score + '%';
            
            // Dynamic Coloring Logic
            if (score >= 80) {
                mainScoreEl.className = "text-7xl sm:text-9xl font-black italic text-emerald-500";
                scoreRing.className = "absolute inset-2 rounded-full border-[6px] border-emerald-500 animate-spin-slow";
                scoreGlow.className = "absolute inset-[-10px] rounded-full blur-2xl opacity-20 bg-emerald-500";
                badge.innerText = "Elite Compatibility";
                badge.className = "px-6 py-2 rounded-full bg-emerald-600 text-white text-[10px] font-black uppercase tracking-widest inline-block mb-6 shadow-xl shadow-emerald-500/20";
            } else if (score >= 50) {
                mainScoreEl.className = "text-7xl sm:text-9xl font-black italic text-amber-500";
                scoreRing.className = "absolute inset-2 rounded-full border-[6px] border-amber-500 animate-spin-slow";
                scoreGlow.className = "absolute inset-[-10px] rounded-full blur-2xl opacity-20 bg-amber-500";
                badge.innerText = "Target Potential";
                badge.className = "px-6 py-2 rounded-full bg-amber-500 text-white text-[10px] font-black uppercase tracking-widest inline-block mb-6 shadow-xl shadow-amber-500/20";
            } else {
                mainScoreEl.className = "text-7xl sm:text-9xl font-black italic text-rose-500";
                scoreRing.className = "absolute inset-2 rounded-full border-[6px] border-rose-500 animate-spin-slow";
                scoreGlow.className = "absolute inset-[-10px] rounded-full blur-2xl opacity-20 bg-rose-500";
                badge.innerText = "Needs Calibration";
                badge.className = "px-6 py-2 rounded-full bg-rose-600 text-white text-[10px] font-black uppercase tracking-widest inline-block mb-6 shadow-xl shadow-rose-500/20";
            }

            // Parse Strengths and Improvements
            const rawText = data.ats_result;
            const strIdx = rawText.toLowerCase().indexOf('strengths');
            const impIdx = rawText.toLowerCase().indexOf('improvement');
            
            let prosText = "Scan complete.";
            let consText = "Scan complete.";
            
            if (strIdx !== -1 && impIdx !== -1) {
                prosText = rawText.substring(strIdx, impIdx).replace(/strengths:?/i, '').trim();
                consText = rawText.substring(impIdx).replace(/improvement suggestions:?/i, '').trim();
            } else {
                prosText = rawText;
                consText = "Refer to neural gap matrix.";
            }

            const logContainer = document.getElementById('forensic-log-container');
            logContainer.innerHTML = `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                    <!-- PROS SECTION -->
                    <div class="glass p-8 rounded-[2.5rem] border-t-8 border-emerald-500 bg-emerald-500/[0.03] dark:bg-emerald-500/[0.02] relative group">
                        <h3 class="text-2xl font-black italic tracking-tight uppercase flex items-center gap-3 mb-8">
                            <i data-lucide="award" class="text-emerald-500"></i> Core Assets
                        </h3>
                        <ul class="text-emerald-700 dark:text-emerald-400 font-bold text-sm leading-relaxed">
                            ${formatBullets(prosText)}
                        </ul>
                    </div>

                    <!-- CONS SECTION -->
                    <div class="glass p-8 rounded-[2.5rem] border-t-8 border-rose-500 bg-rose-500/[0.03] dark:bg-rose-500/[0.02] relative group">
                        <h3 class="text-2xl font-black italic tracking-tight uppercase flex items-center gap-3 mb-8">
                            <i data-lucide="shield-alert" class="text-rose-500"></i> Critical Gaps
                        </h3>
                        <ul class="text-rose-700 dark:text-rose-400 font-bold text-sm leading-relaxed">
                            ${formatBullets(consText)}
                        </ul>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                     <div class="glass p-8 rounded-[2rem]">
                        <h4 class="text-xs font-black text-slate-500 uppercase tracking-widest mb-4">Ingested Profile Mapping</h4>
                        <div class="text-[10px] text-slate-500 whitespace-pre-wrap font-mono p-4 bg-black/20 rounded-xl max-h-40 overflow-y-auto">${data.parsed_resume}</div>
                     </div>
                     <div class="glass p-8 rounded-[2rem]">
                        <h4 class="text-xs font-black text-slate-500 uppercase tracking-widest mb-4">Target Intelligence Mapping</h4>
                        <div class="text-[10px] text-slate-500 whitespace-pre-wrap font-mono p-4 bg-black/20 rounded-xl max-h-40 overflow-y-auto">${data.parsed_job_description}</div>
                     </div>
                </div>
            `;
            lucide.createIcons();
        }

        function initBackground() {
            document.addEventListener('mousemove', (e) => {
                const x = (e.clientX / window.innerWidth) - 0.5;
                const y = (e.clientY / window.innerHeight) - 0.5;
                const glow = document.getElementById('glow-1');
                if (glow) glow.style.transform = `translate(${x * 50}px, ${y * 50}px)`;
            });
        }
    </script>
</body>
</html>